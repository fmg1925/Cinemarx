<!-- app/views/movies/index.html.erb --> <!-- Vista para buscar pelÃ­culas -->
<% content_for :stylesheets do %>
  <%= stylesheet_link_tag :movies, "data-turbo-track": "reload" %>
<% end %>
<h1><%= t("movies.search") %></h1>

<table>
<%= form_with url: url_for(only_path: true, params: request.query_parameters), method: :get, local: true do %>
<tr>
  <td><%= label_tag :query, t("movies.namesearch") %></td>
  <td><%= text_field_tag :query, params[:query].to_s.strip, id: "movie-search-textbox" %></td>
  <td><%= submit_tag t("search"), id: "movie-search-button" %></td>
</tr>
<% end %>
</table>

<% if @movies.present? %>
  <div id="movies-container">
    <% @movies.each do |movie| %>
      <%= render 'movies/movie', movie: movie %>
    <% end %>
  </div>
<% elsif params[:query].present? %>
  <p><%= t("movies.noresults") %></p>
<% end %>

<div class="pagination">
  <% if params[:query].present? && @movies.present? %>
    <% if @current_page > 1 %>
      <%= link_to t("pagination.previous"), search_movies_path(query: params[:query], page: @current_page - 1), class: "pagination-link" %>
    <% end %>

    <span><%= t("pagination.page") %> <%= @current_page %> / <%= @total_pages %></span>

    <% if @current_page < @total_pages %>
      <%= link_to t("pagination.next"), search_movies_path(query: params[:query], page: @current_page + 1), class: "pagination-link" %>
    <% end %>
  <% end %>
</div>

<%= javascript_include_tag "movie_search", "data-turbo-track": "reload", defer: true %>
<%= javascript_include_tag "movies", "data-turbo-track": "reload", defer: true %>